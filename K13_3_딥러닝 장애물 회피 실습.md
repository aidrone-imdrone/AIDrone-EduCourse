# **ë”¥ëŸ¬ë‹ ê¸°ë°˜ ë¯¸ë‹ˆ ë“œë¡  ì¥ì• ë¬¼ íšŒí”¼ ì‹¤ìŠµ**

## **1. ê°œìš”**
### **í”„ë¡œì íŠ¸ ëª©í‘œ**
ì´ í”„ë¡œì íŠ¸ì—ì„œëŠ” **ë¼ì¦ˆë² ë¦¬íŒŒì´ Zero 2Wì™€ ì¹´ë©”ë¼ë¥¼ ì¥ì°©í•œ ë¯¸ë‹ˆ ë“œë¡ ì„ ì´ìš©í•˜ì—¬, ë”¥ëŸ¬ë‹ì„ ê¸°ë°˜ìœ¼ë¡œ ì¥ì• ë¬¼ì„ íšŒí”¼í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„**í•©ë‹ˆë‹¤. ì‹¤ì‹œê°„ ì˜ìƒ ë¶„ì„ê³¼ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ í™œìš©í•˜ì—¬ ì¥ì• ë¬¼ì„ ê°ì§€í•˜ê³ , ê°ì§€ëœ ì¥ì• ë¬¼ì„ íšŒí”¼í•˜ëŠ” ìë™ ë¹„í–‰ì„ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.

### **í•„ìš”í•œ ê¸°ìˆ  ë° ë¼ì´ë¸ŒëŸ¬ë¦¬**
ë³¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì•„ë˜ì˜ ì£¼ìš” ê¸°ìˆ ê³¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
- **Python**: í”„ë¡œê·¸ë˜ë° ì–¸ì–´
- **OpenCV**: ì‹¤ì‹œê°„ ì˜ìƒ ì²˜ë¦¬
- **TensorFlow/Keras**: ë”¥ëŸ¬ë‹ ëª¨ë¸ í•™ìŠµ ë° ì¶”ë¡ 
- **pyaidrone**: ë“œë¡  ì œì–´ ë¼ì´ë¸ŒëŸ¬ë¦¬
- **NumPy**: ë°ì´í„° ì „ì²˜ë¦¬ ë° ë³€í™˜
- **Raspberry Pi Zero 2W**: ë“œë¡ ì˜ ì—°ì‚° ì¥ì¹˜
- **Camera Module**: ì˜ìƒ ë°ì´í„° ìˆ˜ì§‘

### **ê¸°ëŠ¥ ê°œìš”**
- **ì¹´ë©”ë¼ë¡œ ì‹¤ì‹œê°„ ì˜ìƒ ë°ì´í„° ìˆ˜ì§‘**
- **ìˆ˜ì§‘í•œ ë°ì´í„°ë¡œ CNN ëª¨ë¸ í•™ìŠµ**
- **í•™ìŠµí•œ ëª¨ë¸ì„ ë“œë¡  ì œì–´ ì½”ë“œì— í†µí•©í•˜ì—¬ ì¥ì• ë¬¼ ê°ì§€ ë° íšŒí”¼ êµ¬í˜„**
- **ìë™ ì¥ì• ë¬¼ ê°ì§€ ì‹œ ì¢Œìš° ì´ë™ì„ í†µí•´ íšŒí”¼ í›„ ì§ì§„**

---

## **2. ë°ì´í„° ìˆ˜ì§‘**
ë“œë¡  ì¹´ë©”ë¼ë¥¼ ì´ìš©í•˜ì—¬ ì¥ì• ë¬¼ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê¸° ìœ„í•´, rc.py ì½”ë“œì™€ ì—°ë™í•˜ì—¬ í‚¤ë³´ë“œë¡œ ë“œë¡ ì„ ì¡°ì¢…í•˜ë©´ì„œ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•  ìˆ˜ ìˆë„ë¡ ìˆ˜ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

```python
import cv2
import os
from pyaidrone.aiDrone import *
from pyaidrone.deflib import *
from pyaidrone.ikeyevent import *

# ë°ì´í„° ì €ì¥ ë””ë ‰í† ë¦¬ ì„¤ì •
dataset_path = "./dataset"
if not os.path.exists(dataset_path):
    os.makedirs(dataset_path)

cap = cv.VideoCapture("http://<ê°ì ë“œë¡  IP>/?action=stream")  # ë“œë¡  ì¹´ë©”ë¼ ì‚¬ìš©  EX:  cv.VideoCapture("http://192.168.1.12/?action=stream")

# ë“œë¡  ì´ˆê¸°í™”
aidrone = AIDrone()
ikey = IKeyEvent()
aidrone.Open("COM3")
aidrone.setOption(0)

img_count = 0

while not ikey.isKeyEscPressed():
    ret, frame = cap.read()
    if not ret:
        break
    
    cv2.imshow("Camera", frame)

    if ikey.isKeyEnterPressed():             
        aidrone.takeoff()
    if ikey.isKeySpacePressed():
        aidrone.landing()

    if ikey.isKeyUpPressed():
        aidrone.velocity(FRONT, 100)
    elif ikey.isKeyDownPressed():
        aidrone.velocity(BACK, 100)
    else:
        aidrone.velocity(FRONT, 0)

    if ikey.isKeyRightPressed():
        aidrone.velocity(RIGHT, 100)
    elif ikey.isKeyLeftPressed():
        aidrone.velocity(LEFT, 100)
    else:
        aidrone.velocity(RIGHT, 0) 

    if ikey.isKeyWPressed():
        aidrone.altitude(10)
    elif ikey.isKeyXPressed():
        aidrone.altitude(-10)

    if ikey.isKeyDPressed():
        aidrone.rotation(10) 
    elif ikey.isKeyAPressed():
        aidrone.rotation(-10)
    
    if ikey.isKeySPressed():  # 'S' í‚¤ë¥¼ ëˆŒëŸ¬ ì´ë¯¸ì§€ ì €ì¥
        img_path = os.path.join(dataset_path, f"image_{img_count}.jpg")
        cv2.imwrite(img_path, frame)
        img_count += 1
        print(f"Saved {img_path}")
    
    elif ikey.isKeyQPressed():  # 'Q' í‚¤ë¡œ ì¢…ë£Œ
        break

cap.release()
cv2.destroyAllWindows()
aidrone.Close()
```

ì´ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ë“œë¡  ì¹´ë©”ë¼ê°€ í™œì„±í™”ë˜ë©°, `s` í‚¤ë¥¼ ëˆŒëŸ¬ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## **3. ë”¥ëŸ¬ë‹ ëª¨ë¸ í•™ìŠµ**
### **CNN ëª¨ë¸ êµ¬ì¶• ë° í•™ìŠµ**
ìˆ˜ì§‘í•œ ë°ì´í„°ë¥¼ CNN ëª¨ë¸ì„ ì´ìš©í•˜ì—¬ í•™ìŠµí•©ë‹ˆë‹¤.

```python
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten, Dense
from tensorflow.keras.preprocessing.image import ImageDataGenerator

# ë°ì´í„° ê²½ë¡œ ì„¤ì •
data_gen = ImageDataGenerator(rescale=1./255, validation_split=0.2)

train_data = data_gen.flow_from_directory(
    'dataset',
    target_size=(64, 64),
    batch_size=16,
    class_mode='binary',
    subset='training'
)

val_data = data_gen.flow_from_directory(
    'dataset',
    target_size=(64, 64),
    batch_size=16,
    class_mode='binary',
    subset='validation'
)

# CNN ëª¨ë¸ ì •ì˜
model = Sequential([
    Conv2D(32, (3,3), activation='relu', input_shape=(64, 64, 3)),
    MaxPooling2D(2,2),
    Conv2D(64, (3,3), activation='relu'),
    MaxPooling2D(2,2),
    Flatten(),
    Dense(128, activation='relu'),
    Dense(1, activation='sigmoid')
])

# ëª¨ë¸ ì»´íŒŒì¼
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# ëª¨ë¸ í•™ìŠµ
model.fit(train_data, validation_data=val_data, epochs=10)

# ëª¨ë¸ ì €ì¥
model.save("drone_obstacle_model.h5")
```

ìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ìˆ˜ì§‘ëœ ë°ì´í„°ë¡œ CNN ëª¨ë¸ì„ í•™ìŠµí•  ìˆ˜ ìˆìœ¼ë©°, í•™ìŠµì´ ì™„ë£Œëœ ëª¨ë¸ì€ `drone_obstacle_model.h5` íŒŒì¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.

---

## **4. ë“œë¡  ì œì–´ ì½”ë“œ í†µí•©**
### **í•™ìŠµí•œ ëª¨ë¸ì„ í™œìš©í•˜ì—¬ ë“œë¡ ì„ ì œì–´í•˜ëŠ” ì½”ë“œ**
```python
import cv2
import tensorflow as tf
import numpy as np
from pyaidrone.aiDrone import *
from pyaidrone.deflib import *

# ë”¥ëŸ¬ë‹ ëª¨ë¸ ë¡œë“œ
model = tf.keras.models.load_model("drone_obstacle_model.h5")

# ë“œë¡  ì´ˆê¸°í™”
aidrone = AIDrone()
aidrone.Open("COM3")

# ì¹´ë©”ë¼ ì„¤ì •
cap = cv.VideoCapture("http://<ê°ì ë“œë¡  IP>/?action=stream")  

while True:
    ret, frame = cap.read()
    if not ret:
        break

    # ì˜ìƒ ì „ì²˜ë¦¬
    img = cv2.resize(frame, (64, 64))
    img = np.expand_dims(img, axis=0) / 255.0

    # ì˜ˆì¸¡ ìˆ˜í–‰
    prediction = model.predict(img)

    # ì¥ì• ë¬¼ ê°ì§€ ì—¬ë¶€ íŒë‹¨
    if prediction > 0.5:
        print("ì¥ì• ë¬¼ ê°ì§€! íšŒí”¼ ì¤‘...")
        aidrone.velocity(LEFT, 100)  # ì¥ì• ë¬¼ íšŒí”¼ ë™ì‘
    else:
        print("ì „ì§„ ì¤‘...")
        aidrone.velocity(FRONT, 100)

    cv2.imshow("Drone Camera", frame)

    # ì¢…ë£Œ ì¡°ê±´
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

# ì¢…ë£Œ
cap.release()
cv2.destroyAllWindows()
aidrone.Close()
```

---

## **5. í”„ë¡œì íŠ¸ ìš”ì•½**
### **í•µì‹¬ ê¸°ëŠ¥**
- **ì¹´ë©”ë¼ë¡œ ì¥ì• ë¬¼ ì¸ì‹**
- **CNN ëª¨ë¸ì„ í†µí•´ ì¥ì• ë¬¼ ê°ì§€ í•™ìŠµ**
- **ì¥ì• ë¬¼ ê°ì§€ ì‹œ ìë™ íšŒí”¼ ê¸°ëŠ¥ ì ìš©**

### **í™•ì¥ ê°€ëŠ¥ì„±**
- YOLO ë“± ê°ì²´ íƒì§€ ëª¨ë¸ ì ìš© ê°€ëŠ¥
- ê°•í™”í•™ìŠµì„ ì´ìš©í•œ ìë™ ë¹„í–‰ ê°œì„  ê°€ëŠ¥
- GPSì™€ ê²°í•©í•˜ì—¬ ì¥ì• ë¬¼ í”¼í•˜ê¸° ê²½ë¡œ ìµœì í™” ê°€ëŠ¥

ì´ ì‹¤ìŠµì„ í†µí•´ **ë”¥ëŸ¬ë‹ ê¸°ë°˜ ì‹¤ì‹œê°„ ì˜ìƒ ì²˜ë¦¬ ë° ë“œë¡  ììœ¨ ë¹„í–‰**ì„ ê²½í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸš€

