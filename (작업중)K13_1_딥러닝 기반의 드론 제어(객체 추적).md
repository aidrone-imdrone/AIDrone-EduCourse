# 드론 객체 추적 프로그램 사용설명서

## 개요

이 프로그램은 라즈베리파이 Zero 2W와 카메라, FC를 사용한 코딩용 미니 드론을 제어하기 위한 UI 프로그램입니다. MJPG-streamer 서비스를 통해 라즈베리파이에서 전송된 영상을 받아 특정 물체를 선택하고 추적할 수 있습니다.

## 시스템 요구사항

- Python 3.6 이상
- 필수 라이브러리:
  - PyQt5
  - OpenCV (cv2)
  - NumPy
  - pyaidrone

## 설치 방법

1. 필요한 라이브러리 설치:
```bash
pip install PyQt5 opencv-python numpy
```

2. pyaidrone 라이브러리를 설치하거나 드론 제어 라이브러리가 시스템에 설치되어 있는지 확인하세요.

3. 프로그램 코드를 `drone_tracking.py` 파일로 저장하세요.

## 실행 방법

터미널 또는 명령 프롬프트에서 다음 명령을 실행합니다:

```bash
python drone_tracking.py
```

## 프로그램 인터페이스

프로그램 UI는 두 부분으로 나뉘어 있습니다:
- 왼쪽: 제어 패널 (설정, 상태, 버튼 등)
- 오른쪽: 비디오 디스플레이 영역

### 왼쪽 제어 패널

#### 1. 연결 설정
- **드론 IP**: 라즈베리파이 Zero 2W의 IP 주소를 입력합니다.
- **MJPG 포트**: MJPG-streamer의 포트 번호 (기본값: 80)
- **명령 포트**: 드론 제어 명령을 위한 포트 (기본값: 8081)
- **연결/연결 해제** 버튼: 드론과 비디오 스트림 연결/해제

#### 2. 상태
- 현재 연결 상태 표시
- 추적 상태 표시
- FPS (초당 프레임) 표시

#### 3. 물체 선택 방법
- 사용자에게 물체 선택 및 추적 방법 안내

#### 4. 물체 추적 제어
- **추적 시작** 버튼: 선택한 물체 추적 시작
- **추적 중지** 버튼: 물체 추적 중지 (드론은 호버링 유지)

#### 5. 자세한 객체 정보
- 추적 중인 물체의 위치, 크기, HSV 색상 값 등 정보 표시
- **객체 저장** 버튼: 현재 추적 중인 물체 정보 저장
- **객체 불러오기** 버튼: 저장된 물체 정보 불러오기

#### 6. 비행 제어 설정
- **발강(이륙)** 버튼: 드론 이륙
- **착륙** 버튼: 드론 착륙
- **전진/후진** 버튼: 수동 드론 제어

### 오른쪽 비디오 화면
- 드론 카메라의 실시간 영상 표시
- 추적 중인 물체에 녹색 사각형 표시
- 화면 중앙에 파란색 십자선 표시 (드론 중앙 지점)

## 사용 방법

### 1. 연결 설정
1. 드론 IP 주소와 포트를 입력합니다.
2. "연결" 버튼을 클릭합니다.
3. 상태 표시가 "연결 성공"으로 바뀌면 정상적으로 연결된 것입니다.

### 2. 드론 이륙
1. "발강(이륙)" 버튼을 클릭하거나 Enter 키를 누릅니다.
2. 드론이 이륙하고 약 1m 높이에서 호버링합니다.

### 3. 물체 선택
1. 비디오 화면에서 추적하고자 하는 물체를 마우스로 드래그하여 선택합니다.
2. 선택한 물체는 자동으로 분석되며 HSV 색상 정보가 추출됩니다.
3. 물체 선택 후 상태가 "물체 선택 완료 - '추적 시작' 버튼을 눌러주세요"로 바뀝니다.

### 4. 추적 시작
1. "추적 시작" 버튼을 클릭하거나 P 키를 누릅니다.
2. 드론이 선택한 물체를 추적하기 시작합니다.
3. 물체의 중심이 화면 중앙에 오도록 드론이 자동으로 이동합니다.

### 5. 추적 중지
1. "추적 중지" 버튼을 클릭하거나 O 키를 누릅니다.
2. 드론이 추적을 중지하고 현재 위치에서 호버링합니다.

### 6. 착륙
1. "착륙" 버튼을 클릭하거나 Space 키를 누릅니다.
2. 드론이 추적을 중지하고 착륙합니다.

### 7. 연결 해제
1. "연결 해제" 버튼을 클릭하거나 Esc 키를 누릅니다.
2. 드론 연결 및 비디오 스트림 연결이 해제됩니다.

## 단축키

- **Enter**: 이륙
- **Space**: 착륙
- **P**: 추적 시작
- **O**: 추적 중지
- **Esc**: 연결 해제

## 문제 해결

### 연결 실패
- 라즈베리파이의 IP 주소가 올바른지 확인하세요.
- MJPG-streamer가 실행 중인지 확인하세요.
- 포트 번호가 올바른지 확인하세요.
- 네트워크 연결 상태를 확인하세요.

### 추적 중 물체 놓침
- 물체의 움직임이 너무 빠르면 추적이 어려울 수 있습니다.
- 물체의 색상이 배경과 비슷하면 추적이 어려울 수 있습니다.
- 조명 조건이 바뀌면 색상 기반 추적이 실패할 수 있습니다.

## 참고사항

- 드론이 이륙 후 물체를 추적할 수 있으며, 추적할 물체가 화면에 없으면 계속 1m 높이에서 호버링합니다.
- 물체 추적 중 "추적 중지" 버튼을 누르면 드론은 호버링 상태를 유지합니다.
- 물체 추적 중 착륙 버튼을 누르면 추적이 중단되고 드론이 착륙합니다.
- 프로그램을 종료하기 전에 반드시 드론을 착륙시키고 연결을 해제하세요.
